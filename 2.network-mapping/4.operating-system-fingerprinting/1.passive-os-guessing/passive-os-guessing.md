# Network Mapping
## Operating System Fingerprinting
### Passive OS Guessing

#### Objectives
Passive OS guessing will provide information on the O.S. brand and version. This information will be useful to tune active tests (e.g. vulnerability scanning).

Companies should do their best to thwart O.S. identification of critical systems. 

#### Tools
* p0f
* Several protocol analyzers 

#### Examples
Using p0f for scanning incoming connections:
```bash
$ p0f

p0f - passive os fingerprinting utility, version 2.0.5 (C) M. Zalewski <lcamtuf@dione.cc>, W. Stearns <wstearns@pobox.com> 
p0f: listening (SYN) on 'eth0', 231 sigs (13 generic), rule: 'all'. 
192.168.1.101:1298 - Windows XP SP1, 2000 SP3 (2) 
  -> 192.168.1.102:22 (distance 0, link: ethernet/modem) 
192.168.1.102:2298 - Linux 2.5 (sometimes 2.4) (4) (up: 2 hrs) 
  -> 10.1.1.1:80 (distance 0, link: ethernet/modem) 
```

Using p0f for scanning responses to outgoing connections:
```bash
$ p0f -A

p0f - passive os fingerprinting utility, version 2.0.5 (C) M. Zalewski <lcamtuf@dione.cc>, W. Stearns <wstearns@pobox.com> 
p0f: listening (SYN+ACK) on 'eth0', 57 sigs (1 generic), rule: 'all'. 
xxx.xxx.xxx.xxx:80 - FreeBSD 5.0 [high throughput] (up: 1411 hrs) 
  -> 192.168.1.102:2945 (distance 12, link: sometimes DSL (3)) 
```
