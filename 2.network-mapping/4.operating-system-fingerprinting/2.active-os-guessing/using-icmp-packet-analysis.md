# Network Mapping
## Operating System Fingerprinting
### Active OS Guessing - Using ICMP Packet Analysis

#### Objectives
Active OS guessing will provide information on the O.S. brand and version. This information will be useful to tune active tests (e.g. vulnerability scanning).

Companies should do their best to thwart O.S. identification of critical systems.

#### Tools
* Xprobe

#### Examples
Using xprobe2:
```bash
$ xprobe2 192.168.0.254

Xprobe2  v.0.2.2  Copyright  (c)  2002-2005  fyodor@o0o.nu,  ofir@sys-security.com,  meder@o0o.nu

[+] Target is 192.168.0.254 
[+] Loading modules. 
[+] Following modules are loaded: 
[x] [1] ping:icmp_ping  -  ICMP echo discovery module 
[x] [2] ping:tcp_ping  -  TCP-based ping discovery module 
[x] [3] ping:udp_ping  -  UDP-based ping discovery module 
[x] [4] infogather:ttl_calc  -  TCP and UDP based TTL distance calculation 
[x] [5] infogather:portscan  -  TCP and UDP PortScanner 
[x] [6] fingerprint:icmp_echo  -  ICMP Echo request fingerprinting module 
[x] [7] fingerprint:icmp_tstamp  -  ICMP Timestamp request fingerprinting module 
[x] [8] fingerprint:icmp_amask  -  ICMP Address mask request fingerprinting module 
[x]  [9]  fingerprint:icmp_port_unreach    -   ICMP  port  unreachable  fingerprinting  module 
[x] [10] fingerprint:tcp_hshake  -  TCP Handshake fingerprinting module 
[x] [11] fingerprint:tcp_rst  -  TCP RST fingerprinting module
[+] 11 modules registered 
[+] Initializing scan engine 
[+] Running scan engine 
[-] ping:tcp_ping module: no closed/open TCP ports known on 192.168.0.254. Module test failed
[-] ping:udp_ping module: no closed/open UDP ports known on 192.168.0.254. Module test failed
[-] No distance calculation. 192.168.0.254 appears to be dead or no ports known 
[+] Host: 192.168.0.254 is up (Guess probability: 25%) 
[+] Target: 192.168.0.254 is alive. Round-Trip Time: 0.00259 sec 
[+] Selected safe Round-Trip Time value is: 0.00518 sec 
[-] fingerprint:tcp_hshake Module execution aborted (no open TCP ports known) 
[+] Primary guess: 
[+] Host 192.168.0.254 Running OS: "Linux Kernel 2.2.0" (Guess probability: 51%) 
[+] Other guesses: 
[+] Host 192.168.0.254 Running OS: "Linux Kernel 2.2.19" (Guess probability: 51%) 
[+] Host 192.168.0.254 Running OS: "Linux Kernel 2.2.25" (Guess probability: 51%) 
[+] Host 192.168.0.254 Running OS: "Linux Kernel 2.2.17" (Guess probability: 51%) 
[+] Host 192.168.0.254 Running OS: "Linux Kernel 2.2.23" (Guess probability: 51%) 
[+] Host 192.168.0.254 Running OS: "Linux Kernel 2.2.15" (Guess probability: 51%)
[+] Host 192.168.0.254 Running OS: "Linux Kernel 2.2.21" (Guess probability: 51%) 
[+] Host 192.168.0.254 Running OS: "Linux Kernel 2.2.21" (Guess probability: 51%) 
[+] Host 192.168.0.254 Running OS: "Linux Kernel 2.2.15" (Guess probability: 51%) 
[+] Host 192.168.0.254 Running OS: "Linux Kernel 2.2.23" (Guess probability: 51%) 
[+] Cleaning up scan engine 
[+] Modules deinitialized 
[+] Execution completed.
```
