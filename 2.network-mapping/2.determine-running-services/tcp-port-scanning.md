# Network Mapping
## Determine Running Services
### TCP Port Scanning

#### Description
A list of open closed or filtered ports. Services shown by port scanners can be probed for vulnerabilities.

#### Tools
* Nmap
* Netcat
* Hping
* Fscan

#### Examples
Using nmap with SYN stealth scanning and verbose output:
```bash
$ nmap -vv -sS 10.3.8.5

Starting nmap V. 3.81 ( www.insecure.org/nmap/ ) 
Host  (10.3.8.5) appears to be up ... good. 
Initiating SYN Stealth Scan against  (10.3.8.5) 
Adding open port 280/tcp 
Adding open port 515/tcp 
Adding open port 631/tcp 
Adding open port 80/tcp 
Adding open port 9100/tcp 
Adding open port 21/tcp 
Adding open port 23/tcp 
The SYN Stealth Scan took 16 seconds to scan 1601 ports. 
Interesting ports on  (10.3.8.5): 
(The 1594 ports scanned but not shown below are in state: closed) 
Port       State       Service 
21/tcp     open        ftp 
23/tcp     open        telnet 
80/tcp     open        http 
280/tcp    open        http-mgmt 
515/tcp    open        printer 
631/tcp    open        ipp 
9100/tcp   open        jetdirect 
```

Using nmap with complete scan and no ping:
```bash
$ nmap -sT -P0 192.168.1.254

Starting nmap 3.81 ( http://www.insecure.org/nmap/ ) at 2005-06-05 10:42 CDT
Interesting ports on gateway (192.168.1.254): 
(The 1662 ports scanned but not shown below are in state: closed) 
PORT   STATE SERVICE 
80/tcp open  http 
```

Using Hping to create custom SYN+FIN scan (also supported by recent nmap), note how port 22 responds on a Linux system:
```bash
$ hping -SF 192.168.0.254 -p ++20 -c 10

HPING 192.168.0.254 (eth0 192.168.0.254): SF set, 40 headers + 0 data bytes 
len=46 ip=192.168.0.254 ttl=242 DF id=14 sport=20 flags=RA seq=0 win=0 rtt=5.0 ms 
len=46 ip=192.168.0.254 ttl=242 DF id=15 sport=21 flags=RA seq=1 win=0 rtt=5.4 ms 
len=46 ip=192.168.0.254 ttl=242 DF id=0 sport=22 flags=SA seq=2 win=5840 rtt=3.5 ms 
len=46 ip=192.168.0.254 ttl=242 DF id=16 sport=23 flags=RA seq=3 win=0 rtt=4.0 ms 
len=46 ip=192.168.0.254 ttl=242 DF id=17 sport=24 flags=RA seq=4 win=0 rtt=3.5 ms 
len=46 ip=192.168.0.254 ttl=242 DF id=18 sport=25 flags=RA seq=5 win=0 rtt=3.5 ms 
len=46 ip=192.168.0.254 ttl=242 DF id=19 sport=26 flags=RA seq=6 win=0 rtt=4.1 ms 
len=46 ip=192.168.0.254 ttl=242 DF id=20 sport=27 flags=RA seq=7 win=0 rtt=3.4 ms 
len=46 ip=192.168.0.254 ttl=242 DF id=21 sport=28 flags=RA seq=8 win=0 rtt=4.1 ms 
len=46 ip=192.168.0.254 ttl=242 DF id=22 sport=29 flags=RA seq=9 win=0 rtt=3.5 ms 
```
