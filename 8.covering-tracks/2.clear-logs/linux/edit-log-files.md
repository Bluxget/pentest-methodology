# Covering Tracks
## Clear Logs (Unix)
### Edit Log Files

#### Description
**Step One: Locate the logs**

Syslog.conf  contains  storage  path  for  the  log  files.  The  interesting  entries  in  syslog.conf  are, “authpriv”, wtmp, xferlog, maillog and spooler related entries.

```bash
$ cat /etc/syslog.conf
```

Check into following log files from their default location:
```bash
/var/log/messages
/var/log/secure
/var/log/httpd/error_log (log of particular file exploited)
/var/log/httpd/access_log (log of exploit run on web server)
```

If  above  mentioned  files  are  not  available  on  their  default  locations,  check  them  into  syslog.conf


**Step Two: Clear wtmp file**

This file is in binary format, the assessor uses a root-kit program for clearing it. This file is generally used in conjunction with who command. Wzap is one such tool. It clears the user (from the wtmp log) specified by the attacker. 

```bash
$ /opt/wzap

Enter username to zap from  wtmp: owned
Opening file...
Opening output file...
Working...
```

The output file (wtmp.out) will be free from entries for user owned. Simply copy     wtmp.out to wtmp.
```bash
$ cp wtmp.out /var/log/wtmp
```

The entries for user owned are erased from wtmp. To make sure issue following command:
```bash
$ who ./wtmp 
```


**Step Three: Manually editing the logs**

Rest  of  the  logs  files  (messages,  secure,  xferlog  etc)  shall  be  edited  by  using  any  editor.  (vi, emac, nano, joe etc..)

